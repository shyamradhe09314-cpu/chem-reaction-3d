<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>2 H₂ + O₂ → 2 H₂O (3D CSS Demo)</title>
<style>
  :root{
    --bg:#0b0f1a;
    --txt:#e8f0ff;
    --h:#6be3ff;
    --o:#ff5a5a;
    --bond:#bfc6d1;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--txt);font-family:system-ui,Segoe UI,Arial,sans-serif;}
  #hud{position:fixed;inset:12px auto auto 12px;display:flex;gap:10px;align-items:center;font-weight:700}
  #hud small{font-weight:500;opacity:.8}
  #controls{position:fixed;top:12px;right:12px;display:flex;gap:8px}
  button{background:#1c2438;color:var(--txt);border:1px solid #2b3552;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer}
  button:hover{filter:brightness(1.1)}
  #stage{position:absolute;inset:0;display:grid;place-items:center;perspective:900px;touch-action:none}
  .scene{position:relative;width:min(92vw,900px);height:min(70vh,560px);transform-style:preserve-3d}
  .hint{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);opacity:.7;font-size:12px}
  /* Atom */
  .atom{position:absolute;width:56px;height:56px;border-radius:50%;transform-style:preserve-3d;display:grid;place-items:center}
  .atom.H{width:38px;height:38px;background:radial-gradient(circle at 35% 30%, #ffffff, #a0d8ff 60%, #3aa3ff 100%);box-shadow:0 0 18px #3aa3ff55}
  .atom.O{width:64px;height:64px;background:radial-gradient(circle at 35% 30%, #ffd0d0, #ff6b6b 60%, #d11f1f 100%);box-shadow:0 0 18px #ff4d4d66}
  .label{position:absolute;top:100%;left:50%;transform:translate(-50%,6px);font-size:12px;background:#1b2236;padding:2px 6px;border:1px solid #2b3552;border-radius:6px;white-space:nowrap;pointer-events:none}
  /* Bond (simple rectangular rod) */
  .bond{position:absolute;width:6px;height:100px;background:linear-gradient(#e6edf7,#a5b0c2);transform-origin:50% 50%;border-radius:4px;box-shadow:0 0 8px #ffffff29 inset, 0 0 5px #9fb0ca33}
  .bond.double::before{content:"";position:absolute;inset:-12px 0 0 0;left:-10px;width:6px;height:100%;background:linear-gradient(#e6edf7,#a5b0c2);border-radius:4px}
  /* Plus signs & arrow */
  .plus, .arrow{position:absolute;color:#9fb0ca;font-weight:900;font-size:34px;opacity:.9;transform:translateZ(1px)}
  .arrow{font-size:30px}
</style>
</head>
<body>
  <div id="hud">2 H<sub>2</sub> + O<sub>2</sub> → 2 H<sub>2</sub>O <small id="phase">• Reactants</small></div>
  <div id="controls">
    <button id="restart">Restart</button>
    <button id="toggle">Play/Pause</button>
  </div>
  <div id="stage">
    <div class="scene" id="scene">
      <div class="hint">Drag to rotate • Pinch/Scroll to zoom</div>
      <!-- Plus signs / arrow -->
      <div class="plus" id="plus1">+</div>
      <div class="arrow" id="arrow">→</div>
      <!-- Reactant molecules -->
      <div class="atom H" id="H1"><div class="label">H</div></div>
      <div class="atom H" id="H2"><div class="label">H</div></div>
      <div class="atom H" id="H3"><div class="label">H</div></div>
      <div class="atom H" id="H4"><div class="label">H</div></div>
      <div class="atom O" id="O1"><div class="label">O</div></div>
      <div class="atom O" id="O2"><div class="label">O</div></div>
      <!-- Bonds (reactants) -->
      <div class="bond" id="B_H12"></div>
      <div class="bond" id="B_H34"></div>
      <div class="bond double" id="B_O12"></div>

      <!-- Product molecules (initially hidden/off to side) -->
      <div class="atom O" id="PO1"><div class="label">O</div></div>
      <div class="atom H" id="PH1"><div class="label">H</div></div>
      <div class="atom H" id="PH2"><div class="label">H</div></div>
      <div class="atom O" id="PO2"><div class="label">O</div></div>
      <div class="atom H" id="PH3"><div class="label">H</div></div>
      <div class="atom H" id="PH4"><div class="label">H</div></div>
      <div class="bond" id="B_P1_OH1"></div>
      <div class="bond" id="B_P1_OH2"></div>
      <div class="bond" id="B_P2_OH3"></div>
      <div class="bond" id="B_P2_OH4"></div>
    </div>
  </div>

<script>
/* ---------- tiny 3D helper using CSS transforms ---------- */
const scene = document.getElementById('scene');
let rotX = -8, rotY = -20, zoom = 1;
function applySceneTransform(){ scene.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg) scale(${zoom})`; }
applySceneTransform();

// pointer rotate
let dragging=false, lx=0, ly=0;
scene.addEventListener('pointerdown', e=>{dragging=true; lx=e.clientX; ly=e.clientY; scene.setPointerCapture(e.pointerId);});
scene.addEventListener('pointerup',   e=>{dragging=false; scene.releasePointerCapture(e.pointerId);});
scene.addEventListener('pointermove', e=>{ if(!dragging) return; rotY += (e.clientX-lx)*0.2; rotX -= (e.clientY-ly)*0.2; lx=e.clientX; ly=e.clientY; applySceneTransform(); });
scene.addEventListener('wheel', e=>{ e.preventDefault(); const s = (e.deltaY>0)?0.92:1.08; zoom = Math.min(2.2, Math.max(0.6, zoom*s)); applySceneTransform(); }, {passive:false});

// position helper
function place(el, x,y,z){ el.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`; }
function placeBond(bondEl, ax,ay,az, bx,by,bz){
  const dx=bx-ax, dy=by-ay, dz=bz-az;
  const len = Math.sqrt(dx*dx+dy*dy*1 + dz*dz);
  const cx = (ax+bx)/2, cy=(ay+by)/2, cz=(az+bz)/2;
  const yaw   = Math.atan2(dx, dz) * 180/Math.PI;     // rotateY
  const pitch = Math.atan2(dy, Math.hypot(dx,dz)) * 180/Math.PI; // rotateX
  bondEl.style.height = `${len}px`;
  bondEl.style.transformOrigin = '50% 50%';
  bondEl.style.transform = `translate3d(${cx}px, ${cy}px, ${cz}px) rotateY(${yaw}deg) rotateX(${-pitch}deg)`;
}

// units scale
const U=70; // pixels per unit
// initial reactant positions (left: two H2; right: O2)
const pos = {
  H1:[-4*U, -0.7*U,  0], H2:[-3*U, -0.7*U,  0],
  H3:[-4*U,  0.7*U,  0], H4:[-3*U,  0.7*U,  0],
  O1:[ 3.2*U,  0.0,  0], O2:[ 4.4*U,  0.0,  0],
};
// product positions: two bent H2O molecules
const prod = {
  // water #1 at left center
  PO1:[-1.0*U, 0, 0],
  PH1:[-1.65*U,  0.6*U,  0.3*U],
  PH2:[-1.65*U, -0.6*U, -0.3*U],
  // water #2 at right center
  PO2:[ 1.6*U, 0, 0],
  PH3:[ 2.25*U,  0.6*U, -0.3*U],
  PH4:[ 2.25*U, -0.6*U,  0.3*U],
};

// element refs
const el = id => document.getElementById(id);
const H1=el('H1'), H2=el('H2'), H3=el('H3'), H4=el('H4'), O1=el('O1'), O2=el('O2');
const B_H12=el('B_H12'), B_H34=el('B_H34'), B_O12=el('B_O12');
const PO1=el('PO1'), PH1=el('PH1'), PH2=el('PH2'), PO2=el('PO2'), PH3=el('PH3'), PH4=el('PH4');
const B_P1_OH1=el('B_P1_OH1'), B_P1_OH2=el('B_P1_OH2'), B_P2_OH3=el('B_P2_OH3'), B_P2_OH4=el('B_P2_OH4');
const plus1=el('plus1'), arrow=el('arrow');
const phaseTxt=document.getElementById('phase');

// set initial
function initReactants(){
  place(H1, ...pos.H1); place(H2, ...pos.H2);
  place(H3, ...pos.H3); place(H4, ...pos.H4);
  place(O1, ...pos.O1); place(O2, ...pos.O2);
  placeBond(B_H12, ...pos.H1, ...pos.H2);
  placeBond(B_H34, ...pos.H3, ...pos.H4);
  placeBond(B_O12, ...pos.O1, ...pos.O2);

  // products off-screen
  place(PO1, -2000, 0, 0); place(PH1, -2000,0,0); place(PH2, -2000,0,0);
  place(PO2,  2000, 0, 0); place(PH3, 2000,0,0);  place(PH4, 2000,0,0);

  // plus and arrow positions
  place(plus1, -0.3*U, -1.5*U, 0);
  place(arrow,  0.8*U, -1.5*U, 0);
}
initReactants();

// simple tween
function tween(from, to, dur, onUpdate, onDone){
  const start = performance.now();
  function frame(now){
    const t = Math.min(1, (now-start)/dur);
    const u = t<.5 ? 2*t*t : -1+(4-2*t)*t; // easeInOutQuad
    onUpdate(from + (to-from)*u, t);
    if(t<1) requestAnimationFrame(frame); else onDone&&onDone();
  }
  requestAnimationFrame(frame);
}

// animate molecules moving, bonds breaking/forming
let playing=true, schedule=null;
function play(){
  if(schedule){ return; }
  schedule = [];
  phaseTxt.textContent = '• Reactants approaching';

  // move left H2 to center-left, right O2 to center, other H2 to center-right
  const targets = {
    H1:[-2.2*U,-0.7*U,0], H2:[-1.2*U,-0.7*U,0],
    H3:[ 2.2*U, 0.7*U,0], H4:[ 3.2*U, 0.7*U,0],
    O1:[ 0.4*U, 0,0], O2:[ 1.6*U,0,0]
  };

  // 1) approach (2.2s)
  let coords = { ...pos };
  const keys = Object.keys(targets);
  tween(0,1,2200,(v)=>{
    keys.forEach(k=>{
      const s = coords[k] || pos[k];
      const t = targets[k];
      const x = s[0] + (t[0]-s[0])*v;
      const y = s[1] + (t[1]-s[1])*v;
      const z = s[2] + (t[2]-s[2])*v;
      if(k.startsWith('H')) place(eval(k), x,y,z);
      else if(k.startsWith('O')) place(eval(k), x,y,z);
    });
    placeBond(B_H12, H1.offsetLeft, H1.offsetTop,0, H2.offsetLeft, H2.offsetTop,0);
    placeBond(B_H34, H3.offsetLeft, H3.offsetTop,0, H4.offsetLeft, H4.offsetTop,0);
    placeBond(B_O12, O1.offsetLeft, O1.offsetTop,0, O2.offsetLeft, O2.offsetTop,0);
  },()=>{
    // 2) break bonds (0.8s fade)
    phaseTxt.textContent='• Bonds breaking';
    [B_H12,B_H34,B_O12].forEach(b=>b.style.transition='opacity .8s', b=>b.style.opacity=.15);
    setTimeout(()=>{
      [B_H12,B_H34,B_O12].forEach(b=>b.style.display='none');
      // 3) form products
      phaseTxt.textContent='• Forming 2 H₂O';
      // move atoms into product positions (2.2s)
      const map = [[PO1,O1],[PH1,H1],[PH2,H2],[PO2,O2],[PH3,H3],[PH4,H4]];
      const startPos = map.map(([P,A])=>[A.offsetLeft,A.offsetTop,0]);
      const endPos   = [prod.PO1,prod.PH1,prod.PH2,prod.PO2,prod.PH3,prod.PH4];
      // show product atoms
      [PO1,PH1,PH2,PO2,PH3,PH4].forEach(a=>a.style.display='block');
      tween(0,1,2200,(v)=>{
        map.forEach((pair,i)=>{
          const [P,A]=pair;
          const s=startPos[i], e=endPos[i];
          const x=s[0]+(e[0]-s[0])*v;
          const y=s[1]+(e[1]-s[1])*v;
          const z=s[2]+(e[2]-s[2])*v;
          place(P, x,y,z);
        });
        // also move original atoms to follow (hide them)
        [H1,H2,H3,H4,O1,O2].forEach(a=>a.style.opacity=1-v);
        // update product bonds
        placeBond(B_P1_OH1, ...prod.PO1, ...prod.PH1);
        placeBond(B_P1_OH2, ...prod.PO1, ...prod.PH2);
        placeBond(B_P2_OH3, ...prod.PO2, ...prod.PH3);
        placeBond(B_P2_OH4, ...prod.PO2, ...prod.PH4);
      },()=>{
        [H1,H2,H3,H4,O1,O2].forEach(a=>a.style.display='none');
        phaseTxt.textContent='• Products (2 × H₂O)';
      });
    },800);
  });
}
play();

document.getElementById('restart').onclick=()=>{
  // reset styles
  [H1,H2,H3,H4,O1,O2,PO1,PH1,PH2,PO2,PH3,PH4,
   B_H12,B_H34,B_O12,B_P1_OH1,B_P1_OH2,B_P2_OH3,B_P2_OH4]
  .forEach(e=>{ e.style.opacity=''; e.style.display=''; e.style.transition=''; });
  initReactants(); phaseTxt.textContent='• Reactants'; play();
};

document.getElementById('toggle').onclick=()=>{
  alert('Play/Pause basic है इस demo में. Replay के लिए Restart दबाएँ.');
};

// initial placement of product bonds
placeBond(B_P1_OH1, ...prod.PO1, ...prod.PH1);
placeBond(B_P1_OH2, ...prod.PO1, ...prod.PH2);
placeBond(B_P2_OH3, ...prod.PO2, ...prod.PH3);
placeBond(B_P2_OH4, ...prod.PO2, ...prod.PH4);
</script>
</body>
</html>
