<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chemical Reaction H2 + O2 → H2O</title>
  <style>
    body { margin: 0; background: black; color: white; overflow: hidden; }
    #info { position: absolute; top: 20px; left: 20px; font-size: 24px; }
    canvas { display: block; }
  </style>
</head>
<body>
  <div id="info">H₂ + O₂ → H₂O (Reaction Demo)</div>

  <!-- Three.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.js"></script>

  <script>
    // Scene, Camera, Renderer
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Light
    const light = new THREE.PointLight(0xffffff, 1.2);
    light.position.set(10, 10, 10);
    scene.add(light);

    // Materials
    const whiteMat = new THREE.MeshPhongMaterial({ color: 0xffffff }); // Hydrogen
    const redMat   = new THREE.MeshPhongMaterial({ color: 0xff0000 }); // Oxygen

    // Atom function
    function atom(radius, material, x, y, z) {
      const sphere = new THREE.Mesh(new THREE.SphereGeometry(radius, 32, 32), material);
      sphere.position.set(x, y, z);
      scene.add(sphere);
      return sphere;
    }

    // Bond function (cylinder)
    function bond(x1, y1, z1, x2, y2, z2) {
      const dir = new THREE.Vector3(x2 - x1, y2 - y1, z2 - z1);
      const length = dir.length();
      const mid = new THREE.Vector3((x1 + x2) / 2, (y1 + y2) / 2, (z1 + z2) / 2);
      const cyl = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, length, 16), new THREE.MeshPhongMaterial({ color: 0xaaaaaa }));
      cyl.position.copy(mid);
      cyl.lookAt(x2, y2, z2);
      cyl.rotateX(Math.PI / 2);
      scene.add(cyl);
      return cyl;
    }

    // Reactants (H2 + O2)
    let H1 = atom(0.3, whiteMat, -2, 0.5, 0);
    let H2 = atom(0.3, whiteMat, -1, 0.5, 0);
    let B1 = bond(-2, 0.5, 0, -1, 0.5, 0);

    let O1 = atom(0.5, redMat, 1, -0.5, 0);
    let O2 = atom(0.5, redMat, 2, -0.5, 0);
    let B2 = bond(1, -0.5, 0, 2, -0.5, 0);

    // Products (H2O)
    let H2O_H1, H2O_H2, H2O_O, H2O_B1, H2O_B2;
    let step = 0;

    function showProducts() {
      // Remove reactants
      scene.remove(H1, H2, O1, O2, B1, B2);

      // Add H2O molecule
      H2O_O  = atom(0.5, redMat, 0, 0, 0);
      H2O_H1 = atom(0.3, whiteMat, -1, 0.5, 0);
      H2O_H2 = atom(0.3, whiteMat,  1, 0.5, 0);

      H2O_B1 = bond(0, 0, 0, -1, 0.5, 0);
      H2O_B2 = bond(0, 0, 0,  1, 0.5, 0);
    }

    // Camera
    camera.position.z = 6;

    // Controls
    const controls = new THREE.OrbitControls(camera, renderer.domElement);

    // Animate
    function animate() {
      requestAnimationFrame(animate);
      renderer.render(scene, camera);

      // Switch after 3 sec
      if(step === 0 && performance.now() > 3000){
        step = 1;
        showProducts();
      }
    }
    animate();
  </script>
</body>
</html>
